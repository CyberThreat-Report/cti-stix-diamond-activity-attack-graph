import {
  addNodeViewTitleAndText,
  customFieldView, externalReferencesView
} from '../basic';

export const VULNERABILITY_TYPE = "vulnerability"

export function getVulnerabilityView(titleId, contentId, typeId, vulnerabilitySDO) {
  document.getElementById(titleId).innerHTML += vulnerabilitySDO.name;
  document.getElementById(typeId).innerHTML += "Vulnerability";

  let el = document.getElementById(contentId);
  const vulnerabilityDIV = document.createElement("div");
  vulnerabilityDIV.id = "vulnerability";

  if (vulnerabilitySDO?.description) addNodeViewTitleAndText(vulnerabilityDIV, "Description:",
    vulnerabilitySDO.description);

  el.appendChild(vulnerabilityDIV);
  customFieldView(vulnerabilityDIV.id, vulnerabilitySDO);
  if (vulnerabilitySDO?.external_references) {
    externalReferencesView(vulnerabilityDIV.id, vulnerabilitySDO.external_references);
  }
}
