import {
  addNodeViewText,
  addNodeViewTitleAndText,
  addNodeViewTitleAndTextList,
  BasicSDOSRO,
  customFieldView, externalReferencesView
} from '../basic';

export const VULNERABILITY_TYPE = "vulnerability"

export interface VulnerabilitySDO extends BasicSDOSRO{
  name: string;
  description?: string;
}

export function getVulnerabilityView(titleId: string, contentId: string, typeId: string,
                                     vulnerabilitySDO: VulnerabilitySDO) {
  document.getElementById(titleId).innerHTML += vulnerabilitySDO.name;
  document.getElementById(typeId).innerHTML += "Vulnerability";

  let el = document.getElementById(contentId);
  const vulnerabilityDIV = document.createElement("div");
  vulnerabilityDIV.id = "vulnerability";

  if (vulnerabilitySDO?.description) addNodeViewText(vulnerabilityDIV, vulnerabilitySDO.description);

  el.appendChild(vulnerabilityDIV);
  customFieldView(vulnerabilityDIV.id, vulnerabilitySDO);
  if (vulnerabilitySDO?.external_references) {
    externalReferencesView(vulnerabilityDIV.id, vulnerabilitySDO.external_references);
  }
}
